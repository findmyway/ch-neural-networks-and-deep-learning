人的视觉感官是这世上最神奇的事情之一。看看下面这串手写字：

![](http://neuralnetworksanddeeplearning.com/images/digits.png)

大多数人都可以毫不费力地识别出这串数字是504192。看起来似乎是件很容易的事，事实上，在人类的每个脑半球中都有一个初级视觉皮层，也被称作V1层，包含了约1.4亿个神经元，这之间又有数百亿的连接。除此之外还有一系列的视觉皮层，如V2、V3、V4和V5层，负责处理更复杂的图像处理。我们可以把大脑看做是一台超级计算机，在经历了上亿年的进化后，才适应了我们所看到的世界。识别手写数字并不容易。尽管人类非常擅长理解双眼所看到的这世界，但由于识别数字几乎是在潜意识中就完成了，以至于我们并不惊讶人类的视觉神经系统解决了这么复杂的问题。

当你动手去写个程序来解决上面的手写字识别时，你就会明白这个问题有多难了。在我们看来很简单的问题似乎一下子变得相当困难了。想想我们是怎么描述一个数字的，比如“9”，“就是一个圈圈带着一个尾巴~”，不过这个描述很难从算法层面上来描述。当你试图使用更加精细的规则来加以描述时，你会陷入到种种例外、特殊情况等等复杂的细节中。唉，似乎很绝望......

神经网络通过另外一种办法来解决这个问题。其核心思想是使用下图所示大量的手写数字作为训练样本。

![](http://neuralnetworksanddeeplearning.com/images/mnist_100_digits.png)

然后，训练系统从上面的样本中去学习。也就是说，神经网络使用样本来自动学习识别手写字说使用的规则。也就是说，通过增加训练样本，神经网络能够从手写字中学到更多，从而提高准确率。尽管上面只列出了100幅图，不过我们可以通过成千上万的样本学习。

在本章，我们会写一个程序来构建神经网络识别这些手写字。整个程序只有72行，而且并没有采用其他的神经网络工具包。但使用这个程序就能够是我们识别数字的准确率达到96%以上。在接下来的章节中，我们会继续深入，将准确率提高到99%以上。事实上，最好的商业神经网络系统已被用在银行支票和邮局的手写字识别系统中。

本书专注于手写字的识别，这是因为在神经网络系统的学习中，手写字的识别是个比较基本的问题，其主要好处在于，这个问题有一定的挑战性——既不太简单，但也不需要多么高深的解决方案或是强大的计算能力。而且通过这个问题还可以学到一些其它的高级技巧，比如深度学习。因此呢，手写数字的识别将贯穿全书。在本书接下来的内容中，我们会讨论如何将这些思想运用到计算机视觉以及语音和自然语言处理等其它领域中。

当然，如果本章仅仅是写一个程序来解决手写数字识别的问题，那么这一章将会短得多。但在这里我们会介绍许多神经网络中的核心基础概念包括两种类型的人工神经元（感知器和sigmoid神经元），以及标准的神经网络算法如SGD（stochastic gradient descent）本章主要是讲清楚为什么它们是这个样子的，再此基础之上，构建对于神经网络的认识。这比简单地告诉你神经网络工作原理要稍微显得啰嗦一些，不过这会让你对神经网络有更深入的认识，我认为这是值得的。最后我们来理解深度学习究竟是什么以及为什么它如此重要。

##感知器

什么是神经网络呢？首先，来介绍一类人工神经元，感知器。感知器最早由[Frank Rosenblatt](http://en.wikipedia.org/wiki/Frank_Rosenblatt) 在 [Warren McCulloch](http://en.wikipedia.org/wiki/Warren_McCulloch)和[Walter Pitts](http://en.wikipedia.org/wiki/Walter_Pitts)的[研究](http://scholar.google.ca/scholar?cluster=4035975255085082870)基础上[提出](http://books.google.ca/books/about/Principles_of_neurodynamics.html?id=7FhRAAAAMAAJ)来的。在如今的一些神经网络中，一类称为*sigmoid 神经元*的人工神经元用得更多，本书和一些现代的神经网络中也主要使用这类神经元。不过要想理解为什么sigmoid神经元是这么定义的，我们需要先深入了解下感知器的原理。

那，感知器是怎么工作的呢？一个感知器接收一些二值化的输入$x_1,x_2,\ldots$,然后产生一个二值化的输出：

![](http://neuralnetworksanddeeplearning.com/images/tikz0.png)

上面这个例子中，感知器有三个输入，$x_1,x_2,x_3$。当然，输入的个数可以更多或者更少。Rosenblatt提出了一个简单的规则来计算输出。他引入了*权重*，$w_1,w_2,\ldots$,来描述输入对于输出的影响程度。感知器的结果要么是0要么是1，其值是由输入层的加权和$\sum_j w_j x_j$ 是否大于某一阈值来决定的。和权值一样，阈值也是感知器的一个参数。用数学的表达方式来描述就是下面这个式子。
<p>
\begin{eqnarray}
  \mbox{output} & = & \left\{ \begin{array}{ll}
      0 & \mbox{if } \sum_j w_j x_j \leq \mbox{ threshold} \\
      1 & \mbox{if } \sum_j w_j x_j > \mbox{ threshold}
      \end{array} \right.
\tag{1}\end{eqnarray}
</p>

这是最基本的数学模型。你可以这么理解，感知器就是把你所知道的信息通过加权后用来做决策。举个简单的例子，比如，周末马上就要到了，市区会有个奶酪节，你很喜欢奶酪，不知道去还是不去。你需要综合考虑下面三个因素：

1. 天气好不好？

2. 你男朋友或者女朋友陪不陪你一起去？

3. 举办奶酪节的地方交通方不方便？

我们可以用变量$x_1，x_2$和$x_3$来表示这三个因素。例如，如果天气好的话那么$x_1=1$，否则的话$x_1=0$，类似的$x_2=1$表示你男朋友或者女朋友想一起去，否则的话$x_2=0$,$x_3$也类似。

现在假设你非常喜欢奶酪，所以呢，木有女朋友陪也没关系，哈哈。但是你很在意天气，如果天气很差的话你是不会去的。你可以用感知器来描述这个决策。一种方法是，给天气赋权值$w_1=6$，另外两个变量$w_2=2$，$w_3=2$分别代表另外两个条件。天气的权值较大，意味着天气的因素对你来说更重要，比女朋友的因素更重要哦~最后，我们设定这个感知器的阈值是5。也就意味着，天气好的话感知器的输出是1，天气不好的话，感知器的输出是0，至于女朋友去不去，交通方不方便这些都不重要了。

通过改变权值和阈值，我们能得到不同的模型。例如，假设阈值是3，这就意味着，a.天气好 b.女朋友一起去而且交通方便 这两个条件中任何一个成立时，你都会去。也就是说，这变成了另外一个不同的模型，降低阈值意味着你更想去参加这个奶酪节。

很明显，感知器并不是描述人类做决策的完整模型。但上面的例子描述了感知器是如何对不同的因素加权后用于最终决策的过程。我们有理由相信一个完整的感知器网络可以用来做决策。

![](http://neuralnetworksanddeeplearning.com/images/tikz1.png)

上面这个神经网络中的第一层，对输入作加权求和。那么第二层呢？第二层的感知器对第一层感知器的输出做加权求和。也就是说，第二层感知器相比第一层的感知器而言，要在更加复杂而抽象的层面做出决策。第三层的感知器做更复杂的决策。这就意味着，多层的神经网络可以模拟一个相当复杂的决策。

一开始定义感知器的时候，我们说感知器只有一个输出，但是上面的神经网络看起来似乎有不止一个输出。事实上，这些感知器仍然只有一个输出，只不过，上面那些感知器输出上的箭头是为了表示该输出又作用到下一层的输入上了，这样子画看起来简洁一些，不然我们得先画一个输出然后该输出又分裂并连接到下一层的输入。

简单描述一下感知器。前面的描述$\sum_j w_j x_j > threshold$ 显得有些累赘。我们可以进一步将其简化。首先，将$\sum_j w_j x_j$ 改写为向量的点乘形式。$w \cdot x \equiv \sum_j w_j x_j$,其中$w$和$x$分别表示权值和输入的向量。另一个改变是将threshold移到不等式的另一边，同时用另外一个叫做*偏差*的变量来代替，其中$b \equiv - threshold$。最后感知器模型被改写为下面的式子：

<p>
\begin{eqnarray}
  \mbox{output} = \left\{ 
    \begin{array}{ll} 
      0 & \mbox{if } w\cdot x + b \leq 0 \\
      1 & \mbox{if } w\cdot x + b > 0
    \end{array}
  \right.
\tag{2}\end{eqnarray}
</p>

你可以把偏差看做是感知器偏向于输出1的程度，换个说法，就是激活感知器的程度。对于一个有较大偏差的感知器来说，更容易输出1，而对于偏差值很小（一个很小的负数）的感知器来说，很难输出1.添加对**偏差**的描述只是我们对感知器的改进之一，接下来会看到更多的简化。在后面的内容中，本书不再使用**阈值**，而是**偏差**。

我们提到了感知器可以用来做决策，除此之外，还可以用来做一些逻辑运算，如 与、或、非等操作。例如，假设一个感知器有两个输入，每个的权重是-2，同时偏差是3.如下图所示：

![](http://neuralnetworksanddeeplearning.com/images/tikz2.png)

可以看到输入$0,0$ 的结果是 $1$, 因为$(-2)*0+(-2)*0+3=3$是大于0的正数。类似的运算可以得到$输入 0 1 和 1 0 都会得到结果 1$, 但是输入1 1 会得到结果0，因为$(-2)*1+(-2)*1+3=-1$是个负数。这样我们便得到了一个**与非门**。

上面的这个例子表明，我们可以用感知器来计算简单的逻辑关系。事实上，我们可以感知器网络来描述任意的逻辑关系。这是因为，呵呵，学过离散数学你就懂了。通过与非门可以构造出任意的逻辑关系。例如，构造一个计算按位求和的电路。$x_1 \oplus x_2$，当$x_1 和x_2都是1的时候，进位标识（carry）为1$

![](http://neuralnetworksanddeeplearning.com/images/tikz3.png)

我们用感知器网络来表述上面的电路图如下。

![](http://neuralnetworksanddeeplearning.com/images/tikz4.png)


